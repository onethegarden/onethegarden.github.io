{
    "componentChunkName": "component---src-components-post-template-tsx",
    "path": "/2021-09-13-CentOS에서 Nginx 로 REACT배포/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>회사에서 테스트 서버는 직접 세팅해야 한다고 해서 다른 분의 CentOS가상 서버를 빌려서 테스트 해봤다. OS세팅이 되면 직접 세팅할 거라, 시행착오를 겪었던 내용을 정리한다.</p>\n<h2>Node 설치</h2>\n<ol>\n<li>\n<p>yum repository에 nodeSource 추가</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -</span></span></code></pre>\n</li>\n<li>\n<p>intall node.js</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo yum install nodejs</span></span></code></pre>\n</li>\n</ol>\n<h2>Nginx 설치</h2>\n<ol>\n<li>\n<p>외부 저장소 추가</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">vi /etc/yum.repos.d/nginx.repo</span></span></code></pre>\n<p>저거 열고 이거 붙여넣기, centos/7 이부분은 os/version</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">[nginx]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">name=nginx repo</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">baseurl=http://nginx.org/packages/centos/7/$basearch/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">gpgcheck=0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">enabled=1</span></span></code></pre>\n</li>\n<li>\n<p>방화벽 포트 개방, 8080 열어줌</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">firewall-cmd --permanent --zone=public --add-port=8080/tcp</span></span></code></pre>\n<p>리로드</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">firewall-cmd --reload</span></span></code></pre>\n<p>열린 포트 리스트 확인</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">firewall-cmd --list-ports</span></span></code></pre>\n<p>(Firewall 없을 경우 설치, 사용하게 허용)</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo yum install firewalld</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo systemctl enable firewalld</span></span></code></pre>\n</li>\n<li>\n<p>Nginx 포트 설정 /etc/nginx/conf.d/default.conf</p>\n</li>\n</ol>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo vi /etc/nginx/conf.d/default.conf</span></span></code></pre>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">server {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    listen       8080;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    server_name  localhost;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #access_log  /var/log/nginx/host.access.log  main;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    location / {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        root   /usr/share/nginx/html;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        index  index.html index.htm;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #error_page  404              /404.html;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    # redirect server error pages to the static page /50x.html</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    error_page   500 502 503 504  /50x.html;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    location = /50x.html {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        root   /usr/share/nginx/html;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #location ~ \\.php$ {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    proxy_pass   http://127.0.0.1;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #location ~ \\.php$ {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    root           html;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    fastcgi_pass   127.0.0.1:9000;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    fastcgi_index  index.php;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    include        fastcgi_params;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    # deny access to .htaccess files, if Apache&#39;s document root</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    # concurs with nginx&#39;s one</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #location ~ /\\.ht {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #    deny  all;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<ol start=\"4\">\n<li>\n<p>Nginx 시작</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">systemctl start nginx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">systemctl enable nginx</span></span></code></pre>\n<p>해당 포트로 접근했을 때 연결됐는지 nginx 화면 뜨는지 확인</p>\n</li>\n</ol>\n<h3>build된 파일을 쓸 디렉토리 설정</h3>\n<p>파일 열어서 location 수정</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo vi /etc/nginx/conf.d/default.conf</span></span></code></pre>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">server {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    listen       8080;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    server_name  localhost;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    #access_log  /var/log/nginx/host.access.log  main;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    location / {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        root   /home/onethegarden/myapp/build;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        index  index.html index.htm;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<h3>403 forbidden 문제 해결</h3>\n<p>/home/onethegarden/ 에 권한이 없어서 생기는 일</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo chmod 755 /home/onethegarden</span></span></code></pre>\n<h2>그 외 사용했던 명령어</h2>\n<ul>\n<li>\n<p>외부아이피 확인</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">wget http://ifconfig.me</span></span></code></pre>\n</li>\n<li>\n<p>해당 포트 상태 확인</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-tuw09S\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">netstat -aln | grep 8080</span></span></code></pre>\n</li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .solarized-light { background-color: #FDF6E3; }\n  .solarized-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  \n  /* Monokai Dimmed */\n  @media (prefers-color-scheme: dark) {\n    .grvsc-mm-tuw09S {\n      background-color: #1e1e1e;\n      color: #c5c8c6;\n    }\n    .grvsc-mm-tuw09S .grvsc-line-highlighted::before {\n      background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n      box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n    }\n  }\n</style>","frontmatter":{"title":"CentOS에서 Nginx로 REACT배포"},"fields":{"slug":"/2021-09-13-CentOS에서 Nginx 로 REACT배포/"}}}]}},"pageContext":{"slug":"/2021-09-13-CentOS에서 Nginx 로 REACT배포/"}},
    "staticQueryHashes": ["290286666"]}