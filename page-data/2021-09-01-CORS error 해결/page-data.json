{
    "componentChunkName": "component---src-components-post-template-tsx",
    "path": "/2021-09-01-CORS error 해결/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>CORS Error 해결하기</h1>\n<blockquote>\n<p>CORS : Cross - Origin Resource Sharing</p>\n<p>교차출처리소스 공유는 추가 <a href=\"https://developer.mozilla.org/ko/docs/Glossary/HTTP\">HTTP</a> 헤더를 사용하여, 한 <a href=\"https://developer.mozilla.org/ko/docs/Glossary/Origin\">출처</a>에서 실행 중인 웹 애플리케이션이 다른 출처의 선택한 자원에 접근할 수 있는 권한을 부여하도록 브라우저에 알려주는 체제이다.</p>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/HTTP/CORS#HTTP_%EC%9D%91%EB%8B%B5_%ED%97%A4%EB%8D%94\">MDN</a></p>\n</blockquote>\n<p>다른 도메인에서 API를 요청해 사용할 수 있게 하려면 CORS 규칙이 필요하다. 백엔드 개발자에게 해당 도메인을 허용해 달라고 요청을 해야한다.</p>\n<blockquote>\n<p>웹팩 개발서버의 프록시를 사용하게 되면, 브라우저 API 를 요청 할 때 백엔드 서버에 직접적으로 요청을 하지 않고, 현재 개발서버의 주소로 요청을 하게 됩니다. 그러면 웹팩 개발 서버에서 해당 요청을 받아 그대로 백엔드 서버로 전달하고, 백엔드 서버에서 응답한 내용을 다시 브라우저쪽으로 반환합니다. 웹팩 개발서버의 proxy 설정은 원래 웹팩 설정을 통해서 적용을 하지만, CRA 를 통해 만든 리액트 프로젝트에서는 package.json 에서 <code class=\"language-text\">\"proxy\"</code> 값을 설정하여 쉽게 적용 할 수 있습니다</p>\n<p><a href=\"https://react.vlpt.us/redux-middleware/09-cors-and-proxy.html\">벨로퍼트와 함께하는 모던 리액트</a></p>\n</blockquote>\n<p>하지만 webpack은 <strong>Proxy</strong>라는 기능을 제공한다! CRA로 만든 프로젝트는 package.json의 <code class=\"language-text\">proxy</code>를 통하여 쉽게 적용할 수 있다.</p>\n<p>접속하고자 하는 url을  root 경로에 있는 <code class=\"language-text\">package.json</code>에 입력해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n ... \n  <span class=\"token property\">\"proxy\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http://localhost:4000\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그리고 api 요청하는 부분도 앞에 BASE_URI를 빼고 요청하도록 수정한다. 요청하는 도메인이 생략된 경우 현재페이지를 가리키게 된다</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// const BASE_URI = 'http://localhost:4000'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> UserAPI <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  login<span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>loginForm<span class=\"token operator\">:</span> LoginType<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>UserResponse<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// const response = await axios.post&lt;UserResponse>(`${BASE_URI}/login`, loginForm);</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">post</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>UserResponse<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/login</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> loginForm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>실제로 <code class=\"language-text\">localhost:3000</code> 으로 요청을 했지만, 중간에 프록시 서버를 통해 요청이 갔기 때문에 서버에서는 <code class=\"language-text\">http://localhost:4000</code> 로 요청이 간 것으로 인식하여 CORS에러가 나지 않는다.</p>\n<h2 id=\"production에서는\" style=\"position:relative;\"><a href=\"#production%EC%97%90%EC%84%9C%EB%8A%94\" aria-label=\"production에서는 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>production에서는</h2>\n<p>react와 api가 도메인이 같다면 이대로 진행을 해도 되지만, 도메인이 서로 다르다면 axios의 baseURL로 아래와 같이 설정해 줄 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> host <span class=\"token operator\">=</span>\n  process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'development'</span>\n    <span class=\"token operator\">?</span> <span class=\"token string\">'/'</span>\n    <span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">REACT_APP_API_URI</span> <span class=\"token operator\">||</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> apiClient <span class=\"token operator\">=</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  baseURL<span class=\"token operator\">:</span> host<span class=\"token punctuation\">,</span>\n  withCredentials<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"CORS Error 해결"},"fields":{"slug":"/2021-09-01-CORS error 해결/"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#cors-error-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0\">CORS Error 해결하기</a></p>\n<ul>\n<li><a href=\"#production%EC%97%90%EC%84%9C%EB%8A%94\">production에서는</a></li>\n</ul>\n</li>\n</ul>"}}]}},"pageContext":{"slug":"/2021-09-01-CORS error 해결/"}},
    "staticQueryHashes": ["290286666"]}